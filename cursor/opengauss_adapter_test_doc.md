# OpenGaussAdapter 测试文档

## 测试概述

本文档记录了对 `OpenGaussAdapter` 类的测试实现。测试文件位于 `test/adapter_test.py`，主要测试了 OpenGaussAdapter 的各项功能，包括连接、数据采样、索引创建、性能测试和召回率计算等。测试采用直接方法调用的方式，不使用unittest框架。

## 测试函数

测试文件包含以下三个主要测试函数：

1. **test_opengauss_adapter**: 测试基本功能，包括：
   - 创建适配器实例
   - 连接数据库
   - 采样数据
   - 采样查询数据
   - 创建索引
   - 性能测试
   - 计算召回率
   - 删除索引
   - 关闭连接

2. **test_exact_search**: 测试精确搜索功能，包括：
   - 创建随机向量数据
   - 执行精确搜索
   - 验证搜索结果

3. **test_nearest_neighbors**: 测试最近邻计算功能，包括：
   - 计算最近邻
   - 获取真实结果

## 测试方法

测试采用直接方法调用的方式，使用try-except-finally结构确保异常处理和资源释放。每个测试函数都包含以下步骤：

1. 创建适配器实例
2. 调用相关方法
3. 记录日志
4. 处理异常
5. 关闭连接

## 日志记录

测试使用Python的logging模块记录测试过程和结果，包括：

- 测试开始和完成
- 方法调用成功
- 测试结果
- 错误信息

## 测试数据

测试使用以下数据：

- 对于精确搜索测试，使用随机生成的向量数据
- 对于其他测试，使用适配器配置中指定的表和参数

## 修改历史

| 日期 | 修改内容 | 修改人 |
|------|----------|--------|
| 2023-03-11 | 创建简化版OpenGaussAdapter测试案例 | AI助手 |

## 注意事项

1. 测试直接连接实际数据库，请确保配置文件正确设置
2. 测试可能会创建和删除表和索引，请在测试环境中运行
3. 如需运行测试，请确保已安装所有依赖包：`numpy`, `psycopg2` 等
4. 测试过程中的异常会被捕获并记录，不会导致程序崩溃 